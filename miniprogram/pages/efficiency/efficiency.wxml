<view class="efficiency-page">
  <view class="summary-card" wx:if="{{summary}}">
    <text class="summary-title">效率概览</text>
    <view class="summary-row">
      <text class="label">平均耗时</text>
      <text class="value">{{summary.averageTimeSpent}} 分钟/次</text>
    </view>
    <view class="summary-row">
      <text class="label">平均满意度</text>
      <text class="value">{{summary.averageSatisfaction}} 分</text>
    </view>
    <view class="summary-row">
      <text class="label">最高效时段</text>
      <text class="value">{{summary.mostEfficientTimeSlotText}}</text>
    </view>
    <view class="summary-row">
      <text class="label">统计打卡次数</text>
      <text class="value">{{summary.totalCheckIns}} 次</text>
    </view>
  </view>

  <view wx:if="{{!summary && !loading}}" class="empty-text">暂无打卡数据，先去打几次卡再来看吧～</view>
  <view wx:if="{{loading}}" class="empty-text">加载中...</view>

  <view class="section" wx:if="{{habits.length}}">
    <text class="section-title">按习惯统计</text>
    <view class="habit-item" wx:for="{{habits}}" wx:key="habit_id">
      <view class="habit-header">
        <text class="habit-name">{{item.habit_name}}</text>
        <text class="habit-checkins">打卡 {{item.check_in_count}} 次</text>
      </view>
      <view class="habit-row">
        <text class="label">平均耗时</text>
        <text class="value">{{item.average_time_spent}} 分钟</text>
      </view>
      <view class="habit-row">
        <text class="label">平均满意度</text>
        <text class="value">{{item.average_satisfaction}} 分</text>
      </view>
      <view class="habit-bar-row">
        <view class="bar-label">打卡频率</view>
        <view class="bar-wrapper">
          <view class="bar" style="width: {{item.checkInBarPercent}}%;"></view>
        </view>
      </view>
    </view>

  </view>
</view>
