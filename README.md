# ä¹ æƒ¯æ—¥è®°å°ç¨‹åº

ä¸€ä¸ªå¸®åŠ©ç”¨æˆ·å…»æˆå¥½ä¹ æƒ¯ã€è®°å½•ç”Ÿæ´»çš„å¾®ä¿¡å°ç¨‹åºï¼ŒåŒ…å«ä¹ æƒ¯æ‰“å¡ã€ç¬”è®°è®°å½•ã€æ•°æ®ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚

## é¡¹ç›®ç®€ä»‹

ä¹ æƒ¯æ—¥è®°æ˜¯ä¸€æ¬¾åŸºäºå¾®ä¿¡å°ç¨‹åºçš„ä¹ æƒ¯ç®¡ç†åº”ç”¨ï¼Œå¸®åŠ©ç”¨æˆ·ï¼š
- åˆ›å»ºå’Œç®¡ç†ä¸ªäººä¹ æƒ¯
- æ¯æ—¥æ‰“å¡è®°å½•
- æ’°å†™ç”Ÿæ´»ç¬”è®°
- æŸ¥çœ‹ç»Ÿè®¡æ•°æ®å’Œæˆå°±

## æŠ€æœ¯æ ˆ

### åç«¯
- Node.js + Express.js
- MySQL æ•°æ®åº“
- JWT èº«ä»½è®¤è¯
- PM2 è¿›ç¨‹ç®¡ç†

### å‰ç«¯
- å¾®ä¿¡å°ç¨‹åºåŸç”Ÿæ¡†æ¶
- JavaScript (ES6+)
- WeUI/Vant Weapp ç»„ä»¶åº“

### éƒ¨ç½²
- è…¾è®¯äº‘æœåŠ¡å™¨
- Nginx åå‘ä»£ç†
- SSL/HTTPS

## é¡¹ç›®ç»“æ„

```
dakabij/
â”œâ”€â”€ backend/                 # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routes/              # è·¯ç”±
â”‚   â”œâ”€â”€ server.js            # æœåŠ¡å…¥å£
â”‚   â””â”€â”€ package.json         # ä¾èµ–é…ç½®
â”œâ”€â”€ miniprogram/             # å‰ç«¯å°ç¨‹åº
â”‚   â”œâ”€â”€ pages/               # é¡µé¢
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ images/              # å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ app.js               # å°ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ app.json             # å…¨å±€é…ç½®
â”‚   â””â”€â”€ app.wxss             # å…¨å±€æ ·å¼
â”œâ”€â”€ database_init.sql        # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 14.x
- MySQL >= 5.7
- å¾®ä¿¡å¼€å‘è€…å·¥å…·

### åç«¯éƒ¨ç½²

1. å®‰è£…ä¾èµ–
```bash
cd backend
npm install
```

2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
```

3. åˆå§‹åŒ–æ•°æ®åº“
```bash
mysql -u root -p < database_init.sql
```

4. å¯åŠ¨æœåŠ¡
```bash
npm start
# æˆ–ä½¿ç”¨ PM2
pm2 start server.js --name habit-diary-api
```

### å‰ç«¯å¼€å‘

1. ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€ `miniprogram` ç›®å½•
2. é…ç½® `project.config.json` ä¸­çš„ AppID
3. é…ç½® `app.js` ä¸­çš„ `apiBaseUrl`
4. ç‚¹å‡»ç¼–è¯‘è¿è¡Œ

## åŠŸèƒ½ç‰¹æ€§

### å·²å®ç°åŠŸèƒ½

#### åç«¯ API
- ç”¨æˆ·è®¤è¯ï¼ˆå¾®ä¿¡ç™»å½•ï¼‰
- ä¹ æƒ¯ç®¡ç†ï¼ˆCRUDï¼‰
- æ‰“å¡è®°å½•
- ç¬”è®°ç®¡ç†
- æ•°æ®ç»Ÿè®¡
- å¥åº·æ£€æŸ¥

#### å‰ç«¯é¡µé¢
- é¦–é¡µï¼ˆæ¦‚è§ˆã€å¿«æ·æ“ä½œï¼‰
- ä¹ æƒ¯åˆ—è¡¨ï¼ˆæ‰“å¡ã€ç®¡ç†ï¼‰
- ç¬”è®°åˆ—è¡¨ï¼ˆæœç´¢ã€æŸ¥çœ‹ï¼‰
- ç»Ÿè®¡é¡µé¢ï¼ˆæ•°æ®å›¾è¡¨ã€æˆå°±ï¼‰
- ä¸ªäººä¸­å¿ƒï¼ˆè®¾ç½®ã€ç”¨æˆ·ä¿¡æ¯ï¼‰

### å¾…å¼€å‘åŠŸèƒ½

- ä¹ æƒ¯åˆ›å»ºé¡µé¢
- ä¹ æƒ¯è¯¦æƒ…é¡µé¢
- ç¬”è®°åˆ›å»ºé¡µé¢
- ç¬”è®°è¯¦æƒ…é¡µé¢
- æ—¥å†è§†å›¾
- æ•°æ®å¯¼å‡º
- ç¤¾äº¤åˆ†äº«
- æé†’é€šçŸ¥

## API æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

- åŸºç¡€URL: `http://129.211.62.76:3001/api`
- è®¤è¯æ–¹å¼: JWT Token

### ä¸»è¦æ¥å£

#### ç”¨æˆ·ç›¸å…³
- `POST /wechat/login` - å¾®ä¿¡ç™»å½•
- `GET /user/info` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /user/info` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

#### ä¹ æƒ¯ç›¸å…³
- `GET /habits` - è·å–ä¹ æƒ¯åˆ—è¡¨
- `POST /habits` - åˆ›å»ºä¹ æƒ¯
- `PUT /habits/:id` - æ›´æ–°ä¹ æƒ¯
- `DELETE /habits/:id` - åˆ é™¤ä¹ æƒ¯
- `POST /habits/:id/check-in` - æ‰“å¡

#### ç¬”è®°ç›¸å…³
- `GET /notes` - è·å–ç¬”è®°åˆ—è¡¨
- `POST /notes` - åˆ›å»ºç¬”è®°
- `PUT /notes/:id` - æ›´æ–°ç¬”è®°
- `DELETE /notes/:id` - åˆ é™¤ç¬”è®°

#### ç»Ÿè®¡ç›¸å…³
- `GET /statistics/overview` - æ•°æ®æ¦‚è§ˆ
- `GET /statistics/weekly` - å‘¨ç»Ÿè®¡æ•°æ®

## éƒ¨ç½²è¯´æ˜

### æœåŠ¡å™¨é…ç½®

- æ“ä½œç³»ç»Ÿ: CentOS 7
- Node.js: 14.x
- MySQL: 5.7
- PM2: è¿›ç¨‹ç®¡ç†

### éƒ¨ç½²æ­¥éª¤

1. å…‹éš†ä»£ç åˆ°æœåŠ¡å™¨
```bash
git clone <repository-url>
cd dakabij
```

2. å®‰è£…ä¾èµ–
```bash
cd backend
npm install --production
```

3. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶
```

4. åˆå§‹åŒ–æ•°æ®åº“
```bash
mysql -u root -p < database_init.sql
```

5. å¯åŠ¨æœåŠ¡
```bash
pm2 start server.js --name habit-diary-api
pm2 save
pm2 startup
```

6. é…ç½® Nginx åå‘ä»£ç†
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location /api {
        proxy_pass http://127.0.0.1:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- ä½¿ç”¨ ES6+ è¯­æ³•
- éµå¾ª Airbnb JavaScript Style Guide
- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥

### æäº¤è§„èŒƒ

ä½¿ç”¨ Conventional Commits è§„èŒƒï¼š

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾ç›¸å…³
```

### åˆ†æ”¯ç®¡ç†

- `main` - ä¸»åˆ†æ”¯ï¼Œç¨³å®šç‰ˆæœ¬
- `develop` - å¼€å‘åˆ†æ”¯
- `feature/*` - åŠŸèƒ½åˆ†æ”¯
- `bugfix/*` - ä¿®å¤åˆ†æ”¯
- `hotfix/*` - ç´§æ€¥ä¿®å¤åˆ†æ”¯

## å¸¸è§é—®é¢˜

### åç«¯æœåŠ¡æ— æ³•å¯åŠ¨

1. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
```bash
netstat -tlnp | grep 3001
```

2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
```bash
mysql -u root -p -e "SHOW DATABASES;"
```

3. æŸ¥çœ‹æ—¥å¿—
```bash
pm2 logs habit-diary-api
```

### å°ç¨‹åºæ— æ³•è¯·æ±‚API

1. æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™é…ç½®
2. æ£€æŸ¥äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™
3. ç¡®è®¤APIåœ°å€é…ç½®æ­£ç¡®
4. æ£€æŸ¥ç½‘ç»œè¯·æ±‚åŸŸåæ˜¯å¦å·²åœ¨å°ç¨‹åºåå°é…ç½®

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: [GitHub Repository]
- é—®é¢˜åé¦ˆ: [Issues]
- é‚®ç®±: support@habitdiary.com

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-25)
- åˆå§‹åŒ–é¡¹ç›®
- å®Œæˆåç«¯APIå¼€å‘
- å®Œæˆå‰ç«¯åŸºç¡€é¡µé¢
- éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

**åšæŒæ¯ä¸€å¤©ï¼Œè®°å½•ç¾å¥½ç”Ÿæ´»** ğŸ¯
